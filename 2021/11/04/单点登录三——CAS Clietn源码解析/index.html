<!DOCTYPE html><html><head><meta charset="utf-8"><title>单点登录三——CAS Client源码分析 | Estralle Tommm&#39;s Warehouse</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="description" content="CAS总结整理。"><meta name="keywords" content="单点登录"><meta property="og:type" content="article"><meta property="og:title" content="单点登录三——CAS Client源码分析"><meta property="og:url" content="https:&#x2F;&#x2F;blog.estralletommm.top&#x2F;2021&#x2F;11&#x2F;04&#x2F;%E5%8D%95%E7%82%B9%E7%99%BB%E5%BD%95%E4%B8%89%E2%80%94%E2%80%94CAS%20Clietn%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90&#x2F;"><meta property="og:site_name" content="Estralle Tommm&#39;s Warehouse"><meta property="og:description" content="CAS总结整理。"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https:&#x2F;&#x2F;wisdomclass.tech&#x2F;image&#x2F;blog&#x2F;20211104image-20211103175837009.png"><meta property="og:image" content="https:&#x2F;&#x2F;wisdomclass.tech&#x2F;image&#x2F;blog&#x2F;20211104image-20211103180948570.png"><meta property="og:image" content="https:&#x2F;&#x2F;wisdomclass.tech&#x2F;image&#x2F;blog&#x2F;20211104image-20211104123636371.png"><meta property="og:image" content="https:&#x2F;&#x2F;wisdomclass.tech&#x2F;image&#x2F;blog&#x2F;20211104image-20211104124757651.png"><meta property="og:image" content="https:&#x2F;&#x2F;wisdomclass.tech&#x2F;image&#x2F;blog&#x2F;20211104image-20211104153923648.png"><meta property="og:image" content="https:&#x2F;&#x2F;wisdomclass.tech&#x2F;image&#x2F;blog&#x2F;20211104image-20211104170331083.png"><meta property="og:image" content="https:&#x2F;&#x2F;wisdomclass.tech&#x2F;image&#x2F;blog&#x2F;20211104image-20211104170403699.png"><meta property="og:image" content="https:&#x2F;&#x2F;wisdomclass.tech&#x2F;image&#x2F;blog&#x2F;20211104image-20211104170752147.png"><meta property="og:image" content="https:&#x2F;&#x2F;wisdomclass.tech&#x2F;image&#x2F;blog&#x2F;20211104image-20211104172127396.png"><meta property="og:image" content="https:&#x2F;&#x2F;wisdomclass.tech&#x2F;image&#x2F;blog&#x2F;20211104image-20211104172708839.png"><meta property="og:image" content="https:&#x2F;&#x2F;wisdomclass.tech&#x2F;image&#x2F;blog&#x2F;20211104image-20211104173138324.png"><meta property="og:image" content="https:&#x2F;&#x2F;wisdomclass.tech&#x2F;image&#x2F;blog&#x2F;20211104image-20211104173915227.png"><meta property="og:image" content="https:&#x2F;&#x2F;wisdomclass.tech&#x2F;image&#x2F;blog&#x2F;20211104image-20211104181033552.png"><meta property="og:updated_time" content="2021-11-04T00:56:04.000Z"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https:&#x2F;&#x2F;wisdomclass.tech&#x2F;image&#x2F;blog&#x2F;20211104image-20211103175837009.png"><link rel="alternate" href="/atom.xml" title="Estralle Tommm&#39;s Warehouse" type="application/atom+xml"><link rel="icon" href="/favicon.png"><link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css"><link rel="stylesheet" href="/css/style.css"></head><body><div id="container"><div id="wrap"><header id="header"><div id="banner"></div><div id="header-outer" class="outer"><div id="header-title" class="inner"><h1 id="logo-wrap"> <a href="/" id="logo">Estralle Tommm&#39;s Warehouse</a></h1></div><div id="header-inner" class="inner"><nav id="main-nav"><a id="main-nav-toggle" class="nav-icon"></a> <a class="main-nav-link" href="/">Home</a> <a class="main-nav-link" href="/archives">Archives</a></nav><nav id="sub-nav"><a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a><a id="nav-search-btn" class="nav-icon" title="搜索"></a></nav><div id="search-form-wrap"><form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://blog.estralletommm.top"></form></div></div></div></header><div class="outer"><section id="main"><article id="post-单点登录三——CAS Clietn源码解析" class="article article-type-post" itemscope itemprop="blogPost"><div class="article-meta"> <a href="/2021/11/04/%E5%8D%95%E7%82%B9%E7%99%BB%E5%BD%95%E4%B8%89%E2%80%94%E2%80%94CAS%20Clietn%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/" class="article-date"><time datetime="2021-11-04T00:56:04.000Z" itemprop="datePublished">2021-11-04</time></a><div class="article-category"> <a class="article-category-link" href="/categories/%E5%8D%95%E7%82%B9%E7%99%BB%E5%BD%95/">单点登录</a></div></div><div class="article-inner"><header class="article-header"><h1 class="article-title" itemprop="name"> 单点登录三——CAS Client源码分析</h1></header><div class="article-entry" itemprop="articleBody"><h1 id="CAS客户端源码解析"><a href="#CAS客户端源码解析" class="headerlink" title="CAS客户端源码解析"></a><center>CAS客户端源码解析</center></h1><h2 id="介绍："><a href="#介绍：" class="headerlink" title="介绍："></a>介绍：</h2><p>​ CAS客户端源码虽说不是很多，但每一个都介绍的话就显得多余了。所以虽说本节是分析客户端源码，实则只是通过正常CAS流程（CAS v1提供的基础单点功能，代理模式是v2的功能，SMAL是 v3的功能）用到的Filter为切入点，做一点引导性的工作。本节基于<code>cas-client-core-3.2.1.jar</code>版本分析。</p><h2 id="源码分析："><a href="#源码分析：" class="headerlink" title="源码分析："></a>源码分析：</h2><p>​ 我们系统集成CASClient一般会在web.xml中配置如下几个过滤器：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 用于单点退出，该监听器和过滤器用于实现单点登出功能，可选配置 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">listener</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">listener-class</span>&gt;</span>org.jasig.cas.client.session.SingleSignOutHttpSessionListener<span class="tag">&lt;/<span class="name">listener-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">listener</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>CAS Single Sign Out Filter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.jasig.cas.client.session.SingleSignOutFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>CAS Single Sign Out Filter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/SSOLogout<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 该过滤器负责用户的认证工作 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>CASFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.jasig.cas.client.authentication.AuthenticationFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">param-name</span>&gt;</span>casServerLoginUrl<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!--这里的server是CAS服务端的登录地址,login为固定值--&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">param-value</span>&gt;</span>https://host:port/cas/login<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">param-name</span>&gt;</span>serverName<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">param-value</span>&gt;</span>https://host:port<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>CASFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/SSOLogin<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 该过滤器负责对Ticket的校验工作，必须启用它 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>CAS Validation Filter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.jasig.cas.client.validation.Cas20ProxyReceivingTicketValidationFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>casServerUrlPrefix<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--这里的server是CAS服务端的地址,这里不要加login--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>https://host:port/cas<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>serverName<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>https://host:port<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encodeServiceUrl<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--去身份认证的校验的时候也需要加一个编码--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>CAS Validation Filter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/SSOLogin<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 该过滤器负责实现HttpServletRequest请求的包裹，比如允许开发者通过HttpServletRequest的getRemoteUser()方法获得SSO登录用户的登录名。 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>CAS HttpServletRequest Wrapper Filter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.jasig.cas.client.util.HttpServletRequestWrapperFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>CAS HttpServletRequest Wrapper Filter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/SSOLogin<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure><p>那么每一个过滤器或者监听器是干什么的呢？结合上一节的CAS流程我们一起看一下。</p><h3 id="1、AuthenticationFilter"><a href="#1、AuthenticationFilter" class="headerlink" title="1、AuthenticationFilter"></a>1、AuthenticationFilter</h3><blockquote><p>每个人都不是独立存在社会中，身上少不了你爸的财产，你妈的美貌。—— 刚编的</p></blockquote><p>Java类也是一样，我们先看看AuthenticationFilter的继承关系：</p><p><img src="https://wisdomclass.tech/image/blog/20211104image-20211103175837009.png" alt="image-20211103175837009"></p><p>继承关系并不复杂四代单传，来看看都是干啥的</p><ul><li><strong>Filter：</strong>这个大家都认识，过滤器接口；</li><li><strong>AbstractConfigurationFilter：</strong>Abstract类，主要功能是获取配置文件值；</li><li><p><strong>AbstractCasFilter ：</strong> Abstract类， 存放所有CAS过滤器的公共代码；</p></li><li><p><strong>AuthenticationFilter：</strong>实现类，主要负责用户的认证工作。</p></li></ul><p>对应上一张继承关系的图，各个类的功能可以参考下图：</p><p><img src="https://wisdomclass.tech/image/blog/20211104image-20211103180948570.png" alt="image-20211103180948570"></p><p>​ 结合CAS流程，分析代码。AuthenticationFilter在服务启动时，会创建对应过滤器实例，并调用init方法完成初始化操作，并且创建实例和init方法只执行一次。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 初始化方法</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 父类init方法会获取配置值并赋值给变量，同时会调用initInternal方法</span></span><br><span class="line">    <span class="keyword">super</span>.init();</span><br><span class="line">    CommonUtils.assertNotNull(<span class="keyword">this</span>.casServerLoginUrl, <span class="string">"casServerLoginUrl cannot be null."</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 获取配置值，赋给变量</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">initInternal</span><span class="params">(<span class="keyword">final</span> FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!isIgnoreInitConfiguration()) &#123;</span><br><span class="line">        <span class="keyword">super</span>.initInternal(filterConfig);</span><br><span class="line">        setCasServerLoginUrl(getPropertyFromInitParams(filterConfig, <span class="string">"casServerLoginUrl"</span>, <span class="keyword">null</span>));</span><br><span class="line">        log.trace(<span class="string">"Loaded CasServerLoginUrl parameter: "</span> + <span class="keyword">this</span>.casServerLoginUrl);</span><br><span class="line">        setRenew(parseBoolean(getPropertyFromInitParams(filterConfig, <span class="string">"renew"</span>, <span class="string">"false"</span>)));</span><br><span class="line">        log.trace(<span class="string">"Loaded renew parameter: "</span> + <span class="keyword">this</span>.renew);</span><br><span class="line">        ......</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>​ 这里可以发现，需要从配置中获取的值，就是我们能配置的值（当没有配置时会有默认值）。比如前面xml文件中</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>casServerLoginUrl<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--这里的server是CAS服务端的登录地址,login为固定值--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>https://url:port/cas/login<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br></pre></td></tr></table></figure><p>​ 就是在过滤器初始化时将<code>https://url:port/cas/login</code>赋值给<code>casServerLoginUrl</code>；</p><p>​ 当请求被AuthenticationFilter过滤到时执行doFilter方法，具体的验证过程和逻辑也就在这个方法里:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(<span class="keyword">final</span> ServletRequest servletRequest, <span class="keyword">final</span> ServletResponse servletResponse, <span class="keyword">final</span> FilterChain filterChain)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> HttpServletRequest request = (HttpServletRequest) servletRequest;</span><br><span class="line">    <span class="keyword">final</span> HttpServletResponse response = (HttpServletResponse) servletResponse;</span><br><span class="line">    <span class="keyword">final</span> HttpSession session = request.getSession(<span class="keyword">false</span>);</span><br><span class="line">    <span class="comment">// 从session中取出Assertion对象；后面会分析到Assertion在何时创建；</span></span><br><span class="line">    <span class="keyword">final</span> Assertion assertion = session != <span class="keyword">null</span> ? (Assertion) session.getAttribute(CONST_CAS_ASSERTION) : <span class="keyword">null</span>;</span><br><span class="line">	<span class="comment">// 如果session中有Assertion对象，表示已经登录过了，放行；</span></span><br><span class="line">    <span class="keyword">if</span> (assertion != <span class="keyword">null</span>) &#123;</span><br><span class="line">        filterChain.doFilter(request, response);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="comment">// 拼接当前请求</span></span><br><span class="line">    <span class="keyword">final</span> String serviceUrl = constructServiceUrl(request, response);</span><br><span class="line">    <span class="comment">// 从request中获取ticket</span></span><br><span class="line">    <span class="keyword">final</span> String ticket = CommonUtils.safeGetParameter(request,getArtifactParameterName());</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">boolean</span> wasGatewayed = <span class="keyword">this</span>.gatewayStorage.hasGatewayedAlready(request, serviceUrl);</span><br><span class="line">	<span class="comment">// 如果ticket存在，放行到下一个过滤器验证；</span></span><br><span class="line">    <span class="keyword">if</span> (CommonUtils.isNotBlank(ticket) || wasGatewayed) &#123;</span><br><span class="line">        filterChain.doFilter(request, response);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">final</span> String modifiedServiceUrl;</span><br><span class="line"></span><br><span class="line">    log.debug(<span class="string">"no ticket and no assertion found"</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.gateway) &#123;</span><br><span class="line">        log.debug(<span class="string">"setting gateway attribute in session"</span>);</span><br><span class="line">        modifiedServiceUrl = <span class="keyword">this</span>.gatewayStorage.storeGatewayInformation(request, serviceUrl);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        modifiedServiceUrl = serviceUrl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (log.isDebugEnabled()) &#123;</span><br><span class="line">        log.debug(<span class="string">"Constructed service url: "</span> + modifiedServiceUrl);</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="comment">// 拼接认证中心登录url</span></span><br><span class="line">    <span class="keyword">final</span> String urlToRedirectTo = CommonUtils.constructRedirectUrl(<span class="keyword">this</span>.casServerLoginUrl, getServiceParameterName(), modifiedServiceUrl, <span class="keyword">this</span>.renew, <span class="keyword">this</span>.gateway);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (log.isDebugEnabled()) &#123;</span><br><span class="line">        log.debug(<span class="string">"redirecting to \""</span> + urlToRedirectTo + <span class="string">"\""</span>);</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="comment">// 重定向</span></span><br><span class="line">    response.sendRedirect(urlToRedirectTo);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>大致流程可以总结一下：</p><ol><li><p>从session中获取名为“<em>const_cas_assertion</em>”的assertion对象，判断assertion是否存在，如果存在，说明已经登录，执行下一个过滤器。如果不存在，执行第2步。</p></li><li><p>生成serviceUrl，从request中获取票据参数ticket，判断ticket是否为空，如果不为空执行下一个过滤器。如果为空，执行第3步。</p></li><li><p>生成重定向URL。</p></li><li><p>跳转到单点登录服务器，显示登录页面，此时第一个过滤器执行完成。</p></li></ol><p>所以 AuthenticationFilter 就是判断是否已经登录（走完一遍CAS流程）？是否有ticket票据（CAS验证通过，但还没验证ticket）？如果都没有就重定向到CAS登录url。判断先后顺序也是<strong>先大后小</strong>。</p><h3 id="2、Cas20ProxyReceivingTicketValidationFilter"><a href="#2、Cas20ProxyReceivingTicketValidationFilter" class="headerlink" title="2、Cas20ProxyReceivingTicketValidationFilter"></a>2、Cas20ProxyReceivingTicketValidationFilter</h3><p>同样我们看一下继承关系</p><p><img src="https://wisdomclass.tech/image/blog/20211104image-20211104123636371.png" alt="image-20211104123636371"></p><p>​ 前三个在刚刚分析AuthenticationFilter的时候已经提及了，如果还不清楚可以回看。</p><ul><li><strong>AbstractTicketValidationFilter：</strong>Abstract类，负责ticket的校验；</li><li><strong>Cas20ProxyReceivingTicketValidationFilter：</strong>实现类，根据是否使用设置了代理参数，初始化TicketValidator（票据校验器）；</li></ul><p>我们可以发现，最有用的验证票据部分被放在了Abstract类中，说明所有继承AbstractTicketValidationFilter的类都是具有校验ticket能力的。AbstractTicketValidationFilter的子类如下：</p><p><img src="https://wisdomclass.tech/image/blog/20211104image-20211104124757651.png" alt="image-20211104124757651"></p><p>​ 结合CAS v1、v2、v3不同版本，对应产生了三个子类，但基础工作都是验证ticket由父类实现。</p><p>​ 单从实现CAS基本流程验证ticket来说，配置三个任意一个过滤器都可以实现，但我在上面的web.xml中配置的是v2版本的Cas20ProxyReceivingTicketValidationFilter，原因是代理模式在在实际生产中用到的很多，而v1的Cas10TicketValidationFilter不支持代理模式，v3的Saml11AuthenticationFilter是引入了SAML。</p><p>​ 这三个实现类的内容都是初始化参数和重写getTicketValidator()方法，得到ticket校验器，这样就能用各自的方式校验。</p><p>​ AbstractTicketValidationFilter中除了基本的字段维护和初始化方法外，我们重点看一下ticket校验的逻辑代码：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(<span class="keyword">final</span> ServletRequest servletRequest, <span class="keyword">final</span> ServletResponse servletResponse, <span class="keyword">final</span> FilterChain filterChain)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line">	<span class="comment">// preFilter被CAS20子类重写，用来执行ticket验证代码之前处理ProxyReceptor请求；</span></span><br><span class="line">    <span class="keyword">if</span> (!preFilter(servletRequest, servletResponse, filterChain)) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">final</span> HttpServletRequest request = (HttpServletRequest) servletRequest;</span><br><span class="line">    <span class="keyword">final</span> HttpServletResponse response = (HttpServletResponse) servletResponse;</span><br><span class="line">    <span class="comment">// 从request中获取ticket；</span></span><br><span class="line">    <span class="keyword">final</span> String ticket = CommonUtils.safeGetParameter(request, getArtifactParameterName());</span><br><span class="line">	<span class="comment">/** </span></span><br><span class="line"><span class="comment">	 * ticket不为空，则执行验证过程；ticket为空直接放行；</span></span><br><span class="line"><span class="comment">     * 此时ticket为空由两种情况：</span></span><br><span class="line"><span class="comment">     * 	1. 还从未到CASService登录认证（因为登录认证后会携带ticket）；</span></span><br><span class="line"><span class="comment">     *	2. 已经完成过一次成功登录（登录完成后TGC有效期内不会再到CASService认证，所以不会有ticket）；</span></span><br><span class="line"><span class="comment">     * 所以从这里分析来看，认证用的filter 和 验证ticket的filter 过滤器配置以及执行顺序颠倒，流程也是严密的，不会有错误。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">if</span> (CommonUtils.isNotBlank(ticket)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (log.isDebugEnabled()) &#123;</span><br><span class="line">            log.debug(<span class="string">"Attempting to validate ticket: "</span> + ticket);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 验证ticket并返回Assertion对象，验证失败会抛出TicketValidationException；</span></span><br><span class="line">            <span class="keyword">final</span> Assertion assertion = <span class="keyword">this</span>.ticketValidator.validate(ticket, constructServiceUrl(request, response));</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (log.isDebugEnabled()) &#123;</span><br><span class="line">                log.debug(<span class="string">"Successfully authenticated user: "</span> + assertion.getPrincipal().getName());</span><br><span class="line">            &#125;</span><br><span class="line">			<span class="comment">// 将assertion存入request；</span></span><br><span class="line">            request.setAttribute(CONST_CAS_ASSERTION, assertion);</span><br><span class="line">			<span class="comment">// 判断是否使用session（useSession字段可以配置，默认true）</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">this</span>.useSession) &#123;</span><br><span class="line">                <span class="comment">// 将assertion存入session中，与前面AuthenticationFilter从session中取assertion对应；</span></span><br><span class="line">                request.getSession().setAttribute(CONST_CAS_ASSERTION, assertion);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 调用成功方法，此方法为空方法并且没有被重写，应该是留给开发者重写，进行验证成功后的个性化操作；</span></span><br><span class="line">            onSuccessfulValidation(request, response, assertion);</span><br><span class="line">			<span class="comment">// 验证成功后是否重定向，redirectAfterValidation可以配置，默认false；</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">this</span>.redirectAfterValidation) &#123;</span><br><span class="line">                log. debug(<span class="string">"Redirecting after successful ticket validation."</span>);</span><br><span class="line">                <span class="comment">// 拼接url重定向；</span></span><br><span class="line">                response.sendRedirect(constructServiceUrl(request, response));</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (<span class="keyword">final</span> TicketValidationException e) &#123;</span><br><span class="line">            <span class="comment">// 返回失败状态</span></span><br><span class="line">            response.setStatus(HttpServletResponse.SC_FORBIDDEN);</span><br><span class="line">            log.warn(e, e);</span><br><span class="line">			<span class="comment">// 调用验证失败方法，与成功方法相同；</span></span><br><span class="line">            onFailedValidation(request, response);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">this</span>.exceptionOnValidationFailure) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> ServletException(e);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="comment">// 放行，执行下一个过滤器；</span></span><br><span class="line">    filterChain.doFilter(request, response);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>​ 当执行完第一个过滤器（AuthenticationFilter）后，跳转到CAS服务器端的登录页面，输入用户名和密码，验证通过后。CAS服务器端会生成TGT，将TGC以cookie返回给浏览器，并将ticket作为重新跳转到应用系统的参数（<a href="https://host:port/SSOLogin?ticket=ST-1-4hH2s5tzsMGCcToDvGCb-cas01.example.org）。此时又进入第一个过滤器AuthenticationFilter，由于存在ticket参数，进入到第二个过滤器TicketValidationFilter，执行doFilter：" target="_blank" rel="noopener">https://host:port/SSOLogin?ticket=ST-1-4hH2s5tzsMGCcToDvGCb-cas01.example.org）。此时又进入第一个过滤器AuthenticationFilter，由于存在ticket参数，进入到第二个过滤器TicketValidationFilter，执行doFilter：</a></p><ol><li>从request获取ticket参数，如果ticket为空，继续处理下一个过滤器。如果参数不为空，验证ticket参数的合法性。</li><li>验证ticket，TicketValidationFilter的validate方法通过httpClient访问CAS服务器端（<a href="https://host:port/cas/serviceValidate?ticket=ST-1-4hH2s5tzsMGCcToDvGCb-cas01.example.org&amp;service=http://host:port/SSOLogin）验证ticket是否正确，并返回assertion对象。如果验证失败，抛出异常，跳转到错误页面。如果验证成功，session会以&quot;_const_cas_assertion_&quot;的名称保存assertion对象，继续处理下一个过滤器。" target="_blank" rel="noopener">https://host:port/cas/serviceValidate?ticket=ST-1-4hH2s5tzsMGCcToDvGCb-cas01.example.org&amp;service=http://host:port/SSOLogin）验证ticket是否正确，并返回assertion对象。如果验证失败，抛出异常，跳转到错误页面。如果验证成功，session会以&quot;_const_cas_assertion_&quot;的名称保存assertion对象，继续处理下一个过滤器。</a></li></ol><h3 id="3、HttpServletRequestWrapperFilter"><a href="#3、HttpServletRequestWrapperFilter" class="headerlink" title="3、HttpServletRequestWrapperFilter"></a>3、HttpServletRequestWrapperFilter</h3><p>​ 这个类与整个单点流程逻辑无关，存在于CAS源码util包下，它的主要功能是对request进行覆盖，使request可以通过一些方法（具体方法之后会讲到）提供认证成功后返回的Assertion的数据（由CAS返回的用户、权限信息都在Assertion对象中，并存在request和session中）。</p><p><img src="https://wisdomclass.tech/image/blog/20211104image-20211104153923648.png" alt="image-20211104153923648"></p><p>​ 我们先来看一下这个类是怎么实现包裹request的：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(<span class="keyword">final</span> ServletRequest servletRequest, <span class="keyword">final</span> ServletResponse servletResponse, <span class="keyword">final</span> FilterChain filterChain)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line">    <span class="comment">// 通过retrievePrincipalFromSessionOrRequest方法从servletRequest中取出用户信息principal；</span></span><br><span class="line">    <span class="keyword">final</span> AttributePrincipal principal = retrievePrincipalFromSessionOrRequest(servletRequest);</span><br><span class="line">	<span class="comment">// 创建CasHttpServletRequestWrapper对象，并放行执行下一个过滤器；</span></span><br><span class="line">    filterChain.doFilter(<span class="keyword">new</span> CasHttpServletRequestWrapper((HttpServletRequest) servletRequest, principal), servletResponse);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 取出用户信息；</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> AttributePrincipal <span class="title">retrievePrincipalFromSessionOrRequest</span><span class="params">(<span class="keyword">final</span> ServletRequest servletRequest)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> HttpServletRequest request = (HttpServletRequest) servletRequest;</span><br><span class="line">    <span class="keyword">final</span> HttpSession session = request.getSession(<span class="keyword">false</span>);</span><br><span class="line">    <span class="comment">// session为空，就从request中取。否则就从session中取出assertion；</span></span><br><span class="line">    <span class="keyword">final</span> Assertion assertion = (Assertion) (session == <span class="keyword">null</span> ? request.getAttribute(AbstractCasFilter.CONST_CAS_ASSERTION) : session.getAttribute(AbstractCasFilter.CONST_CAS_ASSERTION));</span><br><span class="line">	<span class="comment">// 返回assertion中的用户信息；</span></span><br><span class="line">    <span class="keyword">return</span> assertion == <span class="keyword">null</span> ? <span class="keyword">null</span> : assertion.getPrincipal();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>​ 代码不难，问题是过滤向下传递的CasHttpServletRequestWrapper是什么？细心一点就可以从上面包的截图看出HttpServletRequestWrapperFilter有一个内部类，这个内部类就是向下一个过滤器传递的CasHttpServletRequestWrapper对象。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">CasHttpServletRequestWrapper</span> <span class="keyword">extends</span> <span class="title">HttpServletRequestWrapper</span> </span>&#123;</span><br><span class="line">	<span class="comment">// 用户数据对象principal；</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> AttributePrincipal principal;</span><br><span class="line">	<span class="comment">// 构造方法，给principal赋值；</span></span><br><span class="line">    CasHttpServletRequestWrapper(<span class="keyword">final</span> HttpServletRequest request, <span class="keyword">final</span> AttributePrincipal principal) &#123;</span><br><span class="line">        <span class="keyword">super</span>(request);</span><br><span class="line">        <span class="keyword">this</span>.principal = principal;</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="comment">// 返回用户数据principal；</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Principal <span class="title">getUserPrincipal</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.principal;</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="comment">// 获取用户数据中name字段（用户标识）；</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getRemoteUser</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> principal != <span class="keyword">null</span> ? <span class="keyword">this</span>.principal.getName() : <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="comment">// 判断用户是否有role权限</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isUserInRole</span><span class="params">(<span class="keyword">final</span> String role)</span> </span>&#123;...&#125;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">rolesEqual</span><span class="params">(<span class="keyword">final</span> String given, <span class="keyword">final</span> Object candidate)</span> </span>&#123;...&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>​ 这里就明了了，通过构造CasHttpServletRequestWrapper包装，可以让request通过getUserPrincipal方法获取用户信息，通过getRemoteUser获取用户name字段，通过isUserInRole判断用户是否有权限。</p><p>​ 当然这个类是辅助我们开发的，这样我们就可以通过request直接获取用户信息。当然也可以不用这个类，自己在request或者session中得到Assertion对象，通过操作Assertion对象来获取用户信息。</p><h3 id="4、SingleSignOutFilter"><a href="#4、SingleSignOutFilter" class="headerlink" title="4、SingleSignOutFilter"></a>4、SingleSignOutFilter</h3><p>​ 这个就是单点登出的过滤器了，逻辑也很简单</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(<span class="keyword">final</span> ServletRequest servletRequest, <span class="keyword">final</span> ServletResponse servletResponse, <span class="keyword">final</span> FilterChain filterChain)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> HttpServletRequest request = (HttpServletRequest) servletRequest;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (handler.isTokenRequest(request)) &#123;</span><br><span class="line">        <span class="comment">// 如果是带ticket的请求，存储ticket-session的映射关系；</span></span><br><span class="line">        handler.recordSession(request);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (handler.isLogoutRequest(request)) &#123;</span><br><span class="line">        <span class="comment">// 如果是带登出参数的请求，就移除ticket-session映射关系，并将session摧毁；</span></span><br><span class="line">        handler.destroySession(request);</span><br><span class="line">        <span class="comment">// Do not continue up filter chain</span></span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        log.trace(<span class="string">"Ignoring URI "</span> + request.getRequestURI());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    filterChain.doFilter(servletRequest, servletResponse);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>5、SingleSignOutHttpSessionListener</p><p>​ 单点相关的监听器就更没什么内容了，就只干一件事：监听session的destroyed操作，出发该事件的session从ticket-session映射中移除。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sessionDestroyed</span><span class="params">(<span class="keyword">final</span> HttpSessionEvent event)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (sessionMappingStorage == <span class="keyword">null</span>) &#123;</span><br><span class="line">        sessionMappingStorage = getSessionMappingStorage();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">final</span> HttpSession session = event.getSession();</span><br><span class="line">    sessionMappingStorage.removeBySessionById(session.getId());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="验证："><a href="#验证：" class="headerlink" title="验证："></a>验证：</h2><p>准备：</p><ul><li>本地搭建CAS Service；</li><li>和集成CAS Client的系统A，过滤器配置参考上文web.xml；</li></ul><p>通过浏览器调试，查看请求情况和执行顺序。</p><p>1.访问A的登录地址<code>/h5/h5FunctionList/SSO2H5</code>，此时请求被AuthenticationFilter拦截，判断Assertion为空-&gt;ticket为空-&gt;重定向到CAS Service 的登录页面。</p><p>系统A的登录请求：</p><p><img src="https://wisdomclass.tech/image/blog/20211104image-20211104170331083.png" alt="image-20211104170331083"></p><p>重定向到CAS Service登录地址：</p><p><img src="https://wisdomclass.tech/image/blog/20211104image-20211104170403699.png" alt="image-20211104170403699"></p><p>此时浏览器还没有得到系统A的请求响应，是CAS Service返回的，我们可以观察到多了一条cookie，存的是JSESSIONID，这条是浏览器与CAS Service建立的会话。</p><p>浏览器cookie：</p><p><img src="https://wisdomclass.tech/image/blog/20211104image-20211104170752147.png" alt="image-20211104170752147"></p><p>2.输入正确的用户名和密码，CAS Service验证是正确后，创建TGT并存储，生成TGC，并以cookie的形式返回给浏览器，生成ticket，以参数形式加在url后面，重定向到第一次请求系统A登录的请求。此时浏览器会获得第二个cookie为CASTGC。</p><p>提交用户名密码给CAS Service：</p><p><img src="https://wisdomclass.tech/image/blog/20211104image-20211104172127396.png" alt="image-20211104172127396"></p><p>浏览器名为CASTGC的cookie：</p><p><img src="https://wisdomclass.tech/image/blog/20211104image-20211104172708839.png" alt="image-20211104172708839"></p><p>3.系统A的AuthenticationFilter再次过滤到请求：Assertion为空-&gt;ticket不为空-&gt;放行；被第二个拦截器Cas10TicketValidationFilter过滤到请求：ticket不为空-&gt;验证ticket成功-&gt;放行；</p><p><img src="https://wisdomclass.tech/image/blog/20211104image-20211104173138324.png" alt="image-20211104173138324"></p><p>此次请求成功后，浏览器才第一次接收到系统A的响应并记录下JSESSIONID；</p><p><img src="https://wisdomclass.tech/image/blog/20211104image-20211104173915227.png" alt="image-20211104173915227"></p><p>两个JSESSIONID一个是与CAS Service建立的会话，另一个是与系统A建立的会话。</p><p>此时CAS流程已经完成，其他就是一些HttpServletRequestWrapperFilter封装操作，和正常的登录操作。</p><p>4.当再次请求<code>/h5/h5FunctionList/SSO2H5</code>时，会被AuthenticationFilter拦截掉：Assertion不为空（第一次登录ticket验证成功后，assertion被创建并存入request和session）-&gt;放行；</p><p> 被Cas20ProxyReceivingTicketValidationFilter拦截掉：ticket为空（因为没有去CAS Service验证，所以不会有ticket）-&gt;放行；</p><p> CAS流程完成，进行正常登录操作；</p><p>5.登出流程很简单，就不做过多讲解了，有兴趣的朋友可以自己验证。</p><h2 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h2><p>​ 先来看一下这一节涉及到的所有类的结构，让大家能又一个清晰认识：</p><p><img src="https://wisdomclass.tech/image/blog/20211104image-20211104181033552.png" alt="image-20211104181033552"></p><p>​ 其中最重要的两个filter已经用红框标注出，注意加深理解。</p><p>​ 几千字的文章就写了一天的时间，很多具体的细节到现在也不清晰。就当是一次学习练习吧，顺便希望对想了解CAS的人有点帮助。</p><p>​ 下一节就是对应目前工作的项目，具体集成CAS Client的操作手册，希望能对团队和新人有所帮助，让团队开发向着规范、高效、自动化的方向发展。</p></div><footer class="article-footer"> <a data-url="https://blog.estralletommm.top/2021/11/04/%E5%8D%95%E7%82%B9%E7%99%BB%E5%BD%95%E4%B8%89%E2%80%94%E2%80%94CAS%20Clietn%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/" data-id="cle6sor470021dw9jha4a1yp1" class="article-share-link">Share</a><ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8D%95%E7%82%B9%E7%99%BB%E5%BD%95/" rel="tag">单点登录</a></li></ul></footer></div><nav id="article-nav"> <a href="/2021/10/27/%E5%8D%95%E7%82%B9%E7%99%BB%E5%BD%95%E4%BA%8C%E2%80%94%E2%80%94CAS/" id="article-nav-older" class="article-nav-link-wrap"><strong class="article-nav-caption">Older</strong><div class="article-nav-title">单点登录二——CAS</div></a></nav></article></section><aside id="sidebar"><div class="widget-wrap"><h3 class="widget-title">分类</h3><div class="widget"><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/LeetCode%E7%AE%97%E6%B3%95%E9%A2%98/">LeetCode算法题</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Qt/">Qt</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/SQL/">SQL</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hexo%E5%8A%A0%E9%80%9F%E4%BC%98%E5%8C%96/">hexo加速优化</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hexo%E6%97%A0%E6%B3%95%E8%AE%BF%E9%97%AE/">hexo无法访问</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/">java</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux%E5%86%85%E6%A0%B8%E5%88%86%E6%9E%90/">linux内核分析</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/oracle%E6%95%B0%E6%8D%AE%E5%BA%93/">oracle数据库</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%8D%95%E7%82%B9%E7%99%BB%E5%BD%95/">单点登录</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%91%86%E5%A4%B4/">呆头</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%98%93%E9%80%9A%E4%B8%AA%E6%80%A7%E5%8C%96%E5%BC%80%E5%8F%91/">易通个性化开发</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%B5%8B%E8%AF%95/">测试</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/">组成原理</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/">软件测试</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%9D%A2%E8%AF%95/">面试</a></li></ul></div></div><div class="widget-wrap"><h3 class="widget-title">标签</h3><div class="widget"><ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Binder/" rel="tag">Binder</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/C/" rel="tag">C++</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CDN/" rel="tag">CDN</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/C%E8%AF%AD%E8%A8%80/" rel="tag">C语言</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/C%E8%AF%AD%E8%A8%80%EF%BC%8C%E5%B7%A5%E4%BD%9C%E8%80%85%E7%BA%BF%E7%A8%8B/" rel="tag">C语言，工作者线程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/C%E8%AF%AD%E8%A8%80%EF%BC%8C%E5%B7%A5%E4%BD%9C%E8%80%85%E7%BA%BF%E7%A8%8B%EF%BC%8C%E5%AE%8C%E6%88%90%E5%8F%98%E9%87%8F/" rel="tag">C语言，工作者线程，完成变量</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/IDEA/" rel="tag">IDEA</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ISE/" rel="tag">ISE</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Junit/" rel="tag">Junit</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LeetCode/" rel="tag">LeetCode</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/" rel="tag">Linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MySQL/" rel="tag">MySQL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Postman/" rel="tag">Postman</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Qcreator/" rel="tag">Qcreator</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Qt/" rel="tag">Qt</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SQL/" rel="tag">SQL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/abstract/" rel="tag">abstract</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/coding/" rel="tag">coding</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/eclips/" rel="tag">eclips</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/github/" rel="tag">github</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/" rel="tag">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/" rel="tag">java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kfifo/" rel="tag">kfifo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lambda%E8%A1%A8%E8%BE%BE%E5%BC%8F/" rel="tag">lambda表达式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux%E5%86%85%E6%A0%B8/" rel="tag">linux内核</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/loadrunner/" rel="tag">loadrunner</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/oracle/" rel="tag">oracle</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/postman/" rel="tag">postman</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ssm-java/" rel="tag">ssm java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/verilog%EF%BC%8C%E6%8C%87%E4%BB%A4%EF%BC%8CComposition-principle/" rel="tag">verilog，指令，Composition-principle</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B8%83%E7%89%9B%E4%BA%91/" rel="tag">七牛云</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%86%85%E6%A0%B8%E7%BA%BF%E7%A8%8B/" rel="tag">内核线程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%86%85%E6%A0%B8%E7%BA%BF%E7%A8%8B%E5%88%9B%E5%BB%BA/" rel="tag">内核线程创建</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%87%BD%E6%95%B0%E5%BC%8F%E6%8E%A5%E5%8F%A3/" rel="tag">函数式接口</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8A%A0%E9%80%9F%E4%BC%98%E5%8C%96/" rel="tag">加速优化</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8D%95%E7%82%B9%E7%99%BB%E5%BD%95/" rel="tag">单点登录</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%90%8C%E6%AD%A5/" rel="tag">同步</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%91%86%E5%A4%B4/" rel="tag">呆头</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86%E7%AE%97%E6%B3%95/" rel="tag">图像处理算法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%9B%BE%E5%BA%8A/" rel="tag">图床</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A4%9A%E5%AE%A2%E6%88%B7%E7%AB%AF/" rel="tag">多客户端</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%8A%BD%E8%B1%A1%E7%B1%BB/" rel="tag">抽象类</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95/" rel="tag">接口测试</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" rel="tag">数据库</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E6%B3%B5/" rel="tag">数据泵</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84%E7%AE%97%E6%B3%95/" rel="tag">最短路径算法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%A7%BB%E5%8A%A8%E5%86%85%E6%A0%B8/" rel="tag">移动内核</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%AE%80%E5%8D%95%E9%9A%BE%E5%BA%A6/" rel="tag">简单难度</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">算法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BA%BF%E7%A8%8B/" rel="tag">线程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/" rel="tag">组成原理</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%85%BE%E8%AE%AF%E5%BC%80%E5%8F%91%E8%80%85%E5%B9%B3%E5%8F%B0/" rel="tag">腾讯开发者平台</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/" rel="tag">软件测试</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%BF%9B%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1/" rel="tag">进程间通信</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%BF%9B%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1%E5%AE%9E%E7%8E%B0/" rel="tag">进程间通信实现</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%98%9F%E5%88%97/" rel="tag">队列</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E5%AD%98%E5%82%A8/" rel="tag">静态资源存储</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%9D%A2%E8%AF%95/" rel="tag">面试</a></li></ul></div></div><div class="widget-wrap"><h3 class="widget-title">标签云</h3><div class="widget tagcloud"> <a href="/tags/Binder/" style="font-size:10px">Binder</a> <a href="/tags/C/" style="font-size:10px">C++</a> <a href="/tags/CDN/" style="font-size:10px">CDN</a> <a href="/tags/C%E8%AF%AD%E8%A8%80/" style="font-size:16.67px">C语言</a> <a href="/tags/C%E8%AF%AD%E8%A8%80%EF%BC%8C%E5%B7%A5%E4%BD%9C%E8%80%85%E7%BA%BF%E7%A8%8B/" style="font-size:10px">C语言，工作者线程</a> <a href="/tags/C%E8%AF%AD%E8%A8%80%EF%BC%8C%E5%B7%A5%E4%BD%9C%E8%80%85%E7%BA%BF%E7%A8%8B%EF%BC%8C%E5%AE%8C%E6%88%90%E5%8F%98%E9%87%8F/" style="font-size:10px">C语言，工作者线程，完成变量</a> <a href="/tags/IDEA/" style="font-size:10px">IDEA</a> <a href="/tags/ISE/" style="font-size:10px">ISE</a> <a href="/tags/Junit/" style="font-size:13.33px">Junit</a> <a href="/tags/LeetCode/" style="font-size:10px">LeetCode</a> <a href="/tags/Linux/" style="font-size:10px">Linux</a> <a href="/tags/MySQL/" style="font-size:10px">MySQL</a> <a href="/tags/Postman/" style="font-size:10px">Postman</a> <a href="/tags/Qcreator/" style="font-size:10px">Qcreator</a> <a href="/tags/Qt/" style="font-size:10px">Qt</a> <a href="/tags/SQL/" style="font-size:10px">SQL</a> <a href="/tags/abstract/" style="font-size:10px">abstract</a> <a href="/tags/coding/" style="font-size:10px">coding</a> <a href="/tags/eclips/" style="font-size:10px">eclips</a> <a href="/tags/github/" style="font-size:13.33px">github</a> <a href="/tags/hexo/" style="font-size:13.33px">hexo</a> <a href="/tags/java/" style="font-size:16.67px">java</a> <a href="/tags/kfifo/" style="font-size:10px">kfifo</a> <a href="/tags/lambda%E8%A1%A8%E8%BE%BE%E5%BC%8F/" style="font-size:10px">lambda表达式</a> <a href="/tags/linux%E5%86%85%E6%A0%B8/" style="font-size:20px">linux内核</a> <a href="/tags/loadrunner/" style="font-size:10px">loadrunner</a> <a href="/tags/oracle/" style="font-size:10px">oracle</a> <a href="/tags/postman/" style="font-size:13.33px">postman</a> <a href="/tags/ssm-java/" style="font-size:10px">ssm java</a> <a href="/tags/verilog%EF%BC%8C%E6%8C%87%E4%BB%A4%EF%BC%8CComposition-principle/" style="font-size:10px">verilog，指令，Composition-principle</a> <a href="/tags/%E4%B8%83%E7%89%9B%E4%BA%91/" style="font-size:13.33px">七牛云</a> <a href="/tags/%E5%86%85%E6%A0%B8%E7%BA%BF%E7%A8%8B/" style="font-size:13.33px">内核线程</a> <a href="/tags/%E5%86%85%E6%A0%B8%E7%BA%BF%E7%A8%8B%E5%88%9B%E5%BB%BA/" style="font-size:10px">内核线程创建</a> <a href="/tags/%E5%87%BD%E6%95%B0%E5%BC%8F%E6%8E%A5%E5%8F%A3/" style="font-size:10px">函数式接口</a> <a href="/tags/%E5%8A%A0%E9%80%9F%E4%BC%98%E5%8C%96/" style="font-size:16.67px">加速优化</a> <a href="/tags/%E5%8D%95%E7%82%B9%E7%99%BB%E5%BD%95/" style="font-size:16.67px">单点登录</a> <a href="/tags/%E5%90%8C%E6%AD%A5/" style="font-size:10px">同步</a> <a href="/tags/%E5%91%86%E5%A4%B4/" style="font-size:13.33px">呆头</a> <a href="/tags/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86%E7%AE%97%E6%B3%95/" style="font-size:10px">图像处理算法</a> <a href="/tags/%E5%9B%BE%E5%BA%8A/" style="font-size:10px">图床</a> <a href="/tags/%E5%A4%9A%E5%AE%A2%E6%88%B7%E7%AB%AF/" style="font-size:10px">多客户端</a> <a href="/tags/%E6%8A%BD%E8%B1%A1%E7%B1%BB/" style="font-size:10px">抽象类</a> <a href="/tags/%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95/" style="font-size:10px">接口测试</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" style="font-size:13.33px">数据库</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E6%B3%B5/" style="font-size:10px">数据泵</a> <a href="/tags/%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84%E7%AE%97%E6%B3%95/" style="font-size:10px">最短路径算法</a> <a href="/tags/%E7%A7%BB%E5%8A%A8%E5%86%85%E6%A0%B8/" style="font-size:10px">移动内核</a> <a href="/tags/%E7%AE%80%E5%8D%95%E9%9A%BE%E5%BA%A6/" style="font-size:10px">简单难度</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size:10px">算法</a> <a href="/tags/%E7%BA%BF%E7%A8%8B/" style="font-size:10px">线程</a> <a href="/tags/%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/" style="font-size:10px">组成原理</a> <a href="/tags/%E8%85%BE%E8%AE%AF%E5%BC%80%E5%8F%91%E8%80%85%E5%B9%B3%E5%8F%B0/" style="font-size:13.33px">腾讯开发者平台</a> <a href="/tags/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95/" style="font-size:13.33px">软件测试</a> <a href="/tags/%E8%BF%9B%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1/" style="font-size:10px">进程间通信</a> <a href="/tags/%E8%BF%9B%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1%E5%AE%9E%E7%8E%B0/" style="font-size:10px">进程间通信实现</a> <a href="/tags/%E9%98%9F%E5%88%97/" style="font-size:10px">队列</a> <a href="/tags/%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E5%AD%98%E5%82%A8/" style="font-size:10px">静态资源存储</a> <a href="/tags/%E9%9D%A2%E8%AF%95/" style="font-size:10px">面试</a></div></div><div class="widget-wrap"><h3 class="widget-title">归档</h3><div class="widget"><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">十一月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">十月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">九月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">六月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">四月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">三月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">二月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">八月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">六月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">四月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">二月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">一月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">十二月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">十一月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2000/02/">二月 2000</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/1999/11/">十一月 1999</a></li></ul></div></div><div class="widget-wrap"><h3 class="widget-title">最新文章</h3><div class="widget"><ul><li> <a href="/2021/11/04/%E5%8D%95%E7%82%B9%E7%99%BB%E5%BD%95%E4%B8%89%E2%80%94%E2%80%94CAS%20Clietn%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/">单点登录三——CAS Client源码分析</a></li><li> <a href="/2021/10/27/%E5%8D%95%E7%82%B9%E7%99%BB%E5%BD%95%E4%BA%8C%E2%80%94%E2%80%94CAS/">单点登录二——CAS</a></li><li> <a href="/2021/10/26/%E5%8D%95%E7%82%B9%E7%99%BB%E5%BD%95%E4%B8%80%E2%80%94%E2%80%94%E5%8E%9F%E7%90%86/">单点登录一——原理</a></li><li> <a href="/2021/09/06/Oracle%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%89%E8%A3%85%E4%BB%A5%E5%8F%8A%E6%95%B0%E6%8D%AE%E6%B3%B5%E8%BF%98%E5%8E%9F/">oracle数据库还原</a></li><li> <a href="/2021/06/23/%E4%B8%AA%E6%80%A7%E5%8C%96%E5%BC%80%E5%8F%91%E6%80%BB%E7%BB%93_Tom/">易通个性化开发总结</a></li></ul></div></div></aside></div><footer id="footer"><div class="outer"><div id="footer-info" class="inner"> &copy; 2023 Estralle Tommm<br> Powered by <a href="http://hexo.io/" target="_blank">Hexo</a></div></div></footer></div><nav id="mobile-nav"> <a href="/" class="mobile-nav-link">Home</a> <a href="/archives" class="mobile-nav-link">Archives</a></nav><script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script><link rel="stylesheet" href="/fancybox/jquery.fancybox.css"><script src="/fancybox/jquery.fancybox.pack.js"></script><script src="/js/script.js"></script></div></body></html>